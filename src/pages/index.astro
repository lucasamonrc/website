---
import Root from "../layouts/Root.astro";
import { getCollection } from "astro:content";
import { Image } from "astro:assets";
import avatar from "../assets/me.jpg";

const posts = (await getCollection("posts")).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);

const recentPosts = posts.slice(0, 5);

const socials = [
	{ label: "GitHub", href: "https://github.com/lucasamonrc" },
	{ label: "LinkedIn", href: "https://www.linkedin.com/in/lucasamonrc" },
	{ label: "Email", href: "mailto:hello@lucasacastro.com" },
];
---

<Root>
	<section class="mb-16">
		<div class="mb-6 flex items-center gap-5">
			<Image
				src={avatar}
				alt="Lucas Castro"
				width={72}
				height={72}
				class="rounded-full"
			/>
			<div>
				<h1 class="text-2xl font-bold tracking-tight text-text">
					Lucas Castro
				</h1>
				<p class="text-sm text-text-secondary">
					Systems Engineer at Cloudflare
				</p>
			</div>
		</div>
		<p class="mb-4 leading-relaxed text-text">
			Husband, dad, latter-day saint, and programmer. I like write code
			and sometimes words. Previously a founding engineer at <a
				href="https://trinsic.id">Trinsic</a
			>, CS graduate from <a href="https://byu.edu">BYU</a>.
		</p>
		<nav class="flex gap-4">
			{
				socials.map((s) => (
					<a
						href={s.href}
						target={
							s.href.startsWith("http") ? "_blank" : undefined
						}
						rel={
							s.href.startsWith("http")
								? "noopener noreferrer"
								: undefined
						}
						class="text-sm text-text-secondary no-underline transition-colors"
					>
						{s.label}
					</a>
				))
			}
		</nav>
	</section>

	<section>
		<h2
			class="mb-6 text-sm font-medium uppercase tracking-wide text-text-secondary"
		>
			Recent writing
		</h2>
		<div class="flex flex-col gap-6">
			{
				recentPosts.map((post) => (
					<a
						href={`/writing/${post.id}/`}
						class="group block no-underline"
					>
						<div class="flex items-baseline justify-between gap-4">
							<h3 class="font-medium text-text transition-colors group-hover:text-accent">
								{post.data.title}
							</h3>
							<time
								datetime={post.data.pubDate.toISOString()}
								class="shrink-0 text-sm text-text-secondary"
							>
								{post.data.pubDate.toLocaleDateString("en-US", {
									month: "short",
									year: "numeric",
								})}
							</time>
						</div>
						{post.data.description && (
							<p class="mt-1 text-sm leading-relaxed text-text-secondary">
								{post.data.description}
							</p>
						)}
					</a>
				))
			}
		</div>
		<a
			href="/writing"
			class="mt-8 inline-block text-sm text-text-secondary no-underline transition-colors"
		>
			View all posts &rarr;
		</a>
	</section>
</Root>
